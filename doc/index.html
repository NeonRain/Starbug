<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
		<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
		<meta name="keywords" content="Starbug, Website, Web Site, Web Development, Engine, Framework" />
		<meta name="description" content="Built on the Starbug PHP Development Engine. A code and content management engine for PHP developers." />
		<link rel="stylesheet" type="text/css" href="../core/app/public/stylesheets/default.css" media="screen" />
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/dojo/1.3.2/dojo/dojo.xd.js"></script>
		<title>Starbug - Documentation</title>
		<style>
			a{color:#494;text-decoration:none}
			a:hover{text-decoration:underline}
			.faq dt{font-weight:bold;font-size:18px;padding-left:38px;padding-bottom:10px;background:url(../core/public/images/question.gif) no-repeat}
			.faq dd{padding-left:38px;padding-bottom:32px;background:url(../core/public/images/answer.gif) no-repeat}
			.faq dl{margin-top:15px}
			.faq dl dt{background:none;font-size:14px;padding-bottom:2px}
			.faq dl dd{background:none;padding-bottom:10px}
			h2{font-size:24px}
			h3{background:#999;color:#fff;border-top:2px solid #666;border-bottom:2px solid #666;padding:5px 10px;margin-bottom:10px;clear:both}
			h4{margin-bottom:5px;margin-top:15px;font-size:16px;background:#FFF}
			h5{font-size:14px;margin-top:10px}
			h6{font-size:12px}
			.codeblock{margin-bottom:20px}
			.filetree{margin-bottom:10px}
			.filetree, .filetree ul{list-style-type:none}
			.filetree ul{margin-top:5px;margin-bottom:-5px}
			.filetree li{border-top:1px solid}
			.filetree .dir{float:left;width:120px}
			.filetree ul .dir{width:100px}
			.filetree p{margin-left:120px;margin-bottom:0;font-size:12px}
			.filetree ul p{margin-left:100px}
			h3 a{color:#FFF}
			#toc, #toc ul{list-style-type:none;margin-top:5px}
		</style>
	</head>
	<body>
		<div id="shell">
			<h1><a href="./"><span>Starbug</span></a></h1>
			<span id="subhead">PHP website development kit</span>
			<h2>Flight Manual</h2>
			<h3>Table of Contents</h3>
			<ul id="toc">
				<li>
					<a href="#introduction">Section 1: Introduction</a>
					<ul>
						<li><a href="#what-is-starbug">1.1 - What is StarbugPHP?</a></li>
						<li><a href="#why-was-it-built">1.2 - Why was it built?</a></li>
						<li><a href="#terms">1.3 - Basic Terms</a></li>
						<li><a href="#architecture">1.4 - Architecture</a></li>
						<li><a href="#file-structure">1.5 - File Structure</a></li>
					</ul>
				</li>
				<li>
					<a href="#getting-started">Section 2: Getting Started</a>
					<ul>
						<li><a href="#download">2.1 - Download</a></li>
						<li><a href="#installation">2.2 - Installation</a></li>
						<li><a href="#administration">2.3 - Administration</a></li>
						<li><a href="#uri-breakdown">2.4 - How a request is handled</a></li>
						<li><a href="#uris">2.5 - URIs</a></li>
						<li><a href="#pages">2.6 - Pages</a></li>
						<li><a href="#permits">2.6 - Permits</a></li>
					</ul>
				</li>
				<li>
					<a href="#getting-started">Section 3: Working With Data</a>
					<ul>
						<li><a href="#download">3.1 - Query</a></li>
						<li><a href="#installation">3.2 - Store</a></li>
						<li><a href="#administration">3.3 - Remove</a></li>
						<li><a href="#uri-breakdown">3.4 - Filters</a></li>
					</ul>
				</li>
				<li>
					<a href="#getting-started">Section 4: Util</a>
					<ul>
						<li><a href="#download">3.1 - Query</a></li>
						<li><a href="#installation">3.2 - Store</a></li>
						<li><a href="#administration">3.3 - Remove</a></li>
						<li><a href="#uri-breakdown">3.4 - Filters</a></li>
					</ul>
				</li>
				<li>
					<a href="#getting-started">Section 5: Plugins</a>
					<ul>
						<li><a href="#download">3.1 - Query</a></li>
						<li><a href="#installation">3.2 - Store</a></li>
						<li><a href="#administration">3.3 - Remove</a></li>
						<li><a href="#uri-breakdown">3.4 - Filters</a></li>
					</ul>
				</li>
			</ul>
			
			<!--------------------------------------- Section 1 - Introduction ------------------------------------->
			<a name="introduction"></a>
			<h3>Section 1 - Introduction <a class="right" href="#">[back to top]</a></h3>
			
			<!---------------------------------------- 1.1 What is StarbugPHP -------------------------------------->
			<a name="what-is-starbug"></a>
			<h4>1.1 - What is StarbugPHP? <a class="right" href="#">[back to top]</a></h4>
				<p>StarbugPHP is a free and open-source development framework for PHP. StarbugPHP is designed to build websites in a Model-View pattern. This does not make Starbug any less capable or managable then a Model-View-Controller framework.</p>
			
			<!---------------------------------------- 1.2 Why was it built? -------------------------------------->
			<a name="why-was-it-built"></a>
			<h4>1.2 - Why was it built? <a class="right" href="#">[back to top]</a></h4>
				<p>StarbugPHP was concieved out of a lack of satisfaction with other frameworks and the MVC implementation most of them employ.</p>
				<h5>Why no controllers?</h5>
				<p>Starbug surely is an MVC application, but there is only a single Controller - the Request. Starbug doesn't need more controllers because it has a good URI interpretation scheme, and a connected architecture with a rich set of utilities.</p>
				<h5>Uncommon Features</h5>
				<p>The features listed below were found to be less common or overly complex in other frameworks</p>
				<ul>
					<li>Administration through web interface <strong>or</strong> command line</li>
					<li>Easy database management</li>
					<li>Role-based access control</li>
					<li>Easyily extendable</li>
					<li>Efficient architecture</li>
				</ul>
				<h5>Inspiration</h5>
				<p>The development of this framework drew particular inspiration from:</p>
				<ul>
					<li><a href="http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol" rel="nofollow" target="_blank">The HTTP Protocol</a> - Since StarbugPHP&#39;s purpose is to handle HTTP requests, some of it&#39;s core functionality was modeled around the protocol.</li>
					<li>The <a href="http://en.wikipedia.org/wiki/Elegance" rel="nofollow" target="_blank">elegant</a> and powerful <a href="http://www.dojotoolkit.org/" rel="nofollow" target="_blank">Dojo Toolkit</a> - Although it is a JavaScript toolkit, it is one of the most well built and admirable toolkits that I have seen in any language. You will see the following parallels:
						<ul>
							<li><em>dojo.query (DOM queries)</em> &#8594; <em>$sb->query (SQL queries)</em></li>
							<li><em>dojo.import, dojo.provide</em> &#8594; <em>$sb->import, $sb->provide</em></li>
							<li><em>dojo.publish, dojo.subscribe</em> &#8594; <em>$sb->publish, $sb->subscribe</em></li>
							<li><em>dojo.mixin</em> &#8594; <em>$sb->mixin, $model->mixin</em></li>
						</ul>
					</li>
				</ul>
				
			<!---------------------------------------- 1.3 Basic Terms -------------------------------------->
			<a name="terms"></a>
			<h4>1.3 Basic Terms <a class="right" href="#">[back to top]</a></h4>
				<p>Here are some basic terms that you will need to know:</p>
				<ul>
					<li>
						<strong><em>URIs</em></strong>
						<p>A URI or URL is the address of a page in a website. StarbugPHP has a URIs model and table. The paths that are stored apply to any sub-levels as well. That is to say, a path of <em>photos</em> applies to <em>photos/update/10</em> also if a more specific entry does not apply. These paths are relative to the directory StarbugPHP is installed in.</p>
					</li>
					<li>
						<strong><em>Pages</strong></em>
						<p>Pages provide leaf-based content management. When you create Pages, URIs are automatically created or updated when necessary.</p>
					</li>
					<li>
						<strong><em>Views</strong></em>
						<p>Views are simply PHP files that output the pages of your website. A URI will correspond to a view. The path <em>photos/update/10</em> may correspond to <em>app/views/photos/update.php</em>. There are other possibilities also. See the section on URIs for more possibilities.</p>
					</li>
					<li>
						<strong><em>Models</strong></em>
						<p>Models are classes that represent objects in your application and correspond to tables in a database. For example, there is a <em>Users</em> model and a <em>users</em> table. The table would include your site prefix if one is entered during install. The models extend the Table class.</p>
					</li>
					<li>
						<strong><em>Permits</strong></em>
						<p>Permits are used to control privilages. They are applied by role, action and model/table (and row when required). The action can be <em>read</em> (which is used for URIs) or any function of the model.</p>
					</li>
				</ul>
				<h5>Core classes</h5>
				<p>These are the <a href="http://en.wikipedia.org/wiki/Class_(computer_science)" rel="nofollow" target="_blank">classes</a> that comprise StarbugPHP&#39;s core.</p>
				<ul>
					<li>
						<strong><em>Etc</em></strong>
						<p>The configuration class. This class holds configuration constants such as Etc::WEBSITE_URL. These constants are accessible throughout the application.</p></dd>
					</li>
					<li>
						<strong><em>sb</strong></em>
						<p>The sb class is the backbone of Starbug. A global instance $sb is initialized with the application. $sb can be retrieved using the <a href="http://php.net/manual/en/language.variables.scope.php">global keyword</a>. This is neccessary from within functions, such as the class methods of your models. Primarily, this object provides access to data, an import mechanism for utilities, and a publish/subscribe system for plugin functionality.</p>
					</li>
					<li>
						<strong><em>Table</strong></em>
						<p>This is the base class for models. It relies on the facilities of sb. Since the Table is never directly utilized, it is not shown below. Do note, however, that models are classes that extend the Table class.</p>
					</li>
					<li>
						<strong><em>Request</strong></em>
						<p>This class is responsible for interpreting the request and loading the view. The views are simply PHP documents expected to generate output such as HTML.</p>
					</li>
				</ul>
				<h5>Other</h5>
				<ul>
					<li>
						<strong><em>util</strong></em>
						<p>Several utilities are available for tasks such as form building, pagination, data-validation, searching, tagging, thumbnailing, and attaching JavaScript behaviours via the Dojo Toolkit. This utilities can be imported using the <em>$sb-&gt;import</em> method.</p>
					</li>
					<li>
						<strong><em>script</strong></em>
						<p>Scripts are available to manage the database and plugins, as well as generate code. These can either be run from the command line, or through the <em>sb-admin</em> interface.</p>
					</li>
				</ul>
				
			<!---------------------------------------- 1.4 Architecture -------------------------------------->
			<a name="architecture"></a>
			<h4>1.4 Architecture <a class="right" href="#">[back to top]</a></h4>
				<p>The diagram below shows how the various components work together.</p>
				<div style="text-align:center;margin:20px 0"><img src="diagram.png" alt="" /></div>
				<p>The text on arrows pointing to or from <strong><em>sb</em></strong> correspond to <strong><em>sb</em></strong>'s class methods.</p>
				
			<!---------------------------------------- 1.5 File Structure-------------------------------------->	
			<a name="file-structure"></a>
			<h4>1.5 - File Structure <a class="right" href="#">[back to top]</a></h4>
				<p>Now let's take a look at Starbug's file structure.</p>
				<ul class="filetree">
					<li>
						<em class="dir">/app</em>
						<p>- The subfolders of <em>app</em> contain the main code of your application.</p>
						<ul>
							<li>
								<em class="dir">./models</em>
								<p>- All of your Models will be kept in this folder. An new application will have Users.php, Uris.php and Permits.php in this folder.</p>
							</li>
							<li>
								<em class="dir">./views</em>
								<p>- This folder contains your applications main resources, from which you can call upon models, utilities and plugins.</p>
							</li>
							<li>
								<em class="dir">./public</em>
								<p>- This folder contains public resources such as images, stylesheets, and scripts.</p>
							</li>
							<li>
								<em class="dir">./plugins</em>
								<p>- The <em>plugins</em> folder contains available and installed plugins. Note that some plugins are also in <em>/core/app/plugins</em></p>
							</li>
							<li>
								<em class="dir">./themes</em>
								<p>- Themes provide templates for code generation. Generation is achieved with XSLT.</p>
							</li>
						</ul>
					</li>
					<li>
						<em class="dir">/util</em>
						<p>- This folder contains various utilites which can be imported in your application.</p>
						<ul>
							<li>
								<em class="dir">./filters</em>
								<p>- data filters that can be applied in models for validation.</p>
							</li>
						</ul>
					</li>
					<li>
						<em class="dir">/script</em>
						<p>- This folder contains scripts which you can run from a terminal such as <em>./script/db</em>, and <em>./script/plugin</em>.</p>
					</li>
					<li>
						<em class="dir">/core</em>
						<p>- This folder contains Starbug's core files.</p>
					</li>
					<li>
						<em class="dir">/etc</em>
						<p>- As you've hopefully guessed, all configuration files are kept in this folder.</p>
					</li>
					<li>
						<em class="dir">/doc</em>
						<p>- Here lies documentation.</p>
					</li>
					<li>
						<em class="dir">/var</em>
						<p>- Variable application data may be put in this folder.</p>
					</li>
				</ul>
			
			<!----------------------------------Section 2 - Getting Started ------------------------------>	
			<a name="getting-started"></a>
			<h3>Section 2 - Getting Started <a class="right" href="#">[back to top]</a></h3>
			
			<!---------------------------------------- 2.1 Download -------------------------------------->
			<a name="download"></a>
			<h4>2.1 - Download <a class="right" href="#">[back to top]</a></h4>
				<p>You may download  Starbug PHP by either checking out a copy from GitHub or dowloading a copy from the website. You may check out a copy as follows:</p>
				<div class="codeblock">
					<p><strong>$</strong> git clone git://github.com/cogentParadigm/Starbug.git starbug</p>
					<span class="note">Visit <a target="_blank" href="http://www.starbugphp.com">StarbugPHP.com</a> to download a copy.</span>
				</div>
				<p>Once you've checked out a copy, enter the new directory. All commands will be run from this folder.</p>
				<div class="codeblock"><strong>$</strong> cd starbug</div>
				
			<!---------------------------------------- 2.2 - Installation -------------------------------------->
			<a name="installation"></a>
			<h4>2.2 - Installation <a class="right" href="#">[back to top]</a></h4>
				<p>Once you've downloaded or checked out a copy of Starbug, you need to run the installer in a terminal. The installer will ask you for some configuration information.</p>
				<div class="codeblock">
					<p><strong>$</strong> ./etc/install.php</p>
				</div>

			<!---------------------------------------- 2.3 - Administration -------------------------------------->
			<a name="administration"></a>
			<h4>2.3 - Administration <a class="right" href="#">[back to top]</a></h4>
				<p>You may login through through the web interface at <em>/sb-admin</em> to add URIs, CMS Pages, and Permits as well as manage plugins and settings.</p>
				<p>Your login credentials will be established during installation.</p>
				<p>You can also utilize the scripts in the folder <em>scripts/</em>. Run them from the root of your application like this: <div class="codeblock"><strong>$</strong> ./script/db sync</div></p>
				<p>The Starbug administration interface can be accessed by visiting <em>/sb-admin</em> and logging in using the credentials established during installation.</p>
				
			<!---------------------------------------- 2.4 - URI breakdown -------------------------------------->
			<a name="uri-breakdown"></a>
			<h4>2.4 - URI breakdown <a class="right" href="#">[back to top]</a></h4>
				<p>Everytime a user makes a request to the server, there are 2 possible components. The <em>request path</em> (the URI), and POST actions. The <em>request path</em> and POST actions are seperate. Given sufficient permission, any action can be invoked regardless of the <em>request path</em>.</p>
				<h5>The URI</h5>
				<p>The URI maps directly to the view. Here are some example mappings showing what view might be loaded based on the URI:</p>
				<ul>
					<li><em>/photos/create</em> will map to <em>/app/views/photos/create.php</em></li>
					<li><em>/photos/edit/1</em> will map to <em>/app/views/photos/edit.php</em></li>
					<li><em>/photos</em> can map to <em>/app/views/photos.php</em> or <em>/app/views/photos/default.php</em></li>
				</ul>
				<p>To be accessible, you must add the URI via Starbug Admin. All that is required is a prefix of the request path. This means that adding a URI with a path of <em>photos</em> will make all of the above paths accessible. If you add more specific URIs only the most specific available path will be used to determine access.</p>
				<h5>POST actions</h5>
				<p>The post variable <em>$_POST['action']</em> is used to call upon model functions in the format: <em>$_POST['action'][$model] = $action</em>. For example, if a form posted <em>$_POST['action']['users']</em> with a value of '<em>create</em>', sb would attempt to invoke a method called '<em>create</em>' belonging to the model '<em>Users</em>'.</p>
				
			<!---------------------------------------- 2.5 - URIs and Pages -------------------------------------->
			<a name="uris-pages"></a>
			<h4>2.5 - URIs and Pages <a class="right" href="#">[back to top]</a></h4>
				<p>You can add URIs and Pages through sb-admin.</p>
				<h5>URIs</h5>
				<p>URIs have a <strong><em>template</em></strong> and a <strong><em>path</em></strong>.</p>
				<h6>template</h6>
				<p>Entering a value of <em>Main</em> will load <em>app/views/Main.php</em></p>
				<h6>path</h6>
				<p>The path only needs to be a prefix of possible URIs. So a URI entry with a path of <em>photos</em> can provide access to any subpath of <em>photos/</em> without it&#39;s own more specific entry.</p>
				<p>When a URI is entered such as <em>photos/update/2</em>, Starbug will determine what you are trying load and sets <em>$request->file</em> accordingly. From the template, you can load it with:</p>
				<div class="codeblock"><strong>include</strong>($this->file);</div>
				<p>In the example above, the first of these will be set as the <em>$request->file</em>:</p>
				<ul>
					<li><em>app/views/photos.php</em></li>
					<li><em>app/views/photos/update.php</em></li>
					<li><em>app/views/photos/update/2.php</em></li>
					<li><em>app/views/photos/update/2/default.php</em></li>
					<li><em>app/views/photos/update/default.php</em></li>
					<li><em>app/views/photos/default.php</em></li>
				</ul><br/>
				<h6>Adding a URI</h6>
				<ul class="decimal">
					<li>Click on the <em>URIs</em> link in the admin menu.<br/><img src="images/uris_circled.png" /></li>
					<li>Click on <a class="round button">Create URI</a>.</li>
					<li>Enter your path info and click save.</li>
				</ul>
				<h5>Pages</h5>
				<p>Pages have a template which will be the template for the URI. You can create a page and then add leafs to it.</p>
				<h6>Creating a Page</h6>
				<ul class="decimal">
					<li>Click on the <em>Pages</em> link in the admin menu.</li>
					<li>Click on <a class="round button">Create Page</a>.</li>
					<li>Enter URI info and title and click <em>Create</em>.</li>
					<li>Add leafs to the containers in your page.</li>
					<li>Click <em>Save</em> when you are done.</li>
				</ul>
			<h4>Permits</h4>
				<p>Permits are the rules that govern access control. </p>
			<h3>Model</h3>
			<h4>Attribute Reference</h4>
			<table>
				<tr><th>Key</th><th>Possible values</th><th>Default</th><th>Requires</th></tr>
				<tr><td>type</td><td>int, string, bool, datetime, timestamp, file</td><td>none(required)</td><td></td></tr>
				<tr><td>length</td><td>(int max_length), (int min_length):(int max_length)</td><td>type dependant</td><td></td></tr>
				<tr><td>input_type</td><td>text, image, checkbox, submit, file, textarea, hidden, select, date_select, time_select</td><td>text</td><td></td></tr>
				<tr><td>range</td><td>(int from):(int to)</td><td>none</td><td>input_type=select</td></tr>
				<tr><td>time_select</td><td>true, false</td><td>false</td><td>type=datetime | input_type=date_select</td></tr>
			</table>
			<h3>Generate CRUD</h3>
			<h3>In the Request</h3>
			<h3>Conclusion</h3>
			<ul id="footer">
				<li><a href="http://www.starbugphp.com">StarbugPHP</a> &copy; 2008-2009 <a href="http://www.aligangji.com">Ali Gangji</a></li>
				<li><a href="http://www.starbugphp.com/freedoms">freedoms</a></li>
			</ul>
		</div>
	</body>
</html>
